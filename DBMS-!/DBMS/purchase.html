<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title> Purchase </title>
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" type="text/css" href="purchase.css">
  </head>

  <body>
    <div class="search-container">
      <form action="/search" method="GET">
        <input type="text" id="search" name="query" placeholder="search here" style="font-style: italic;">
        <button type="submit"> Search </button>
      </form>
    </div>

    <nav id="sidebar">
      <h2 style="text-align: center;"> RecipÏ† </h2>
      <div class="logo-container">
        <img src="pinkbow.png" alt="Logo">
      </div>
      <ul>
        <li><a class="nav-item" href="dashboard.html"> Home </a></li>
        <li><a class="nav-item" href="recipe.html"> Recipe </a></li>
        <li><a class="nav-item" href="purchase.html"> Purchase </a></li>
        <li><a class="nav-item" href="index.html"> Log Out </a></li>
      </ul>
    </nav>

    <div class="product-container">
      <div class="product-box">
        <div class="product">
          <img src="item/appliances/MH6565DIS.png" class="product-image">
          <h3 class="product-name"> LG 25L Smart Inverter NeoChef Microwave Oven MH6565DIS </h3>
          <p class="product-price" style="text-align: center;"> â‚±8495 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±8495</p> 
        </div>
      </div>

      <div class="product-box">
        <div class="product">
          <img src="item/appliances/MG30T5018CC.png" class="product-image">
          <h3 class="product-name"> Samsung MG30T5018CC/TC 30 Liters Microwave Oven </h3>
          <p class="product-price" style="text-align: center;"> â‚±8495 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±8495 </p> 
        </div>
      </div>

      <div class="product-box">
        <div class="product">
          <img src="item/appliances/MC35R8088LC.png" class="product-image">
          <h3 class="product-name"> Samsung MC35R8088LC 35 Liters Smart Microwave Oven </h3>
          <p class="product-price" style="text-align: center;"> â‚±24995 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±24995 </p> 
        </div>
      </div>

      <div class="product-box">
        <div class="product">
          <img src="item/appliances/MWX-203.jpg" class="product-image">
          <h3 class="product-name"> Whirlpool MWX-203 BL 20 Liters Microwave Oven </h3>
          <p class="product-price" style="text-align: center;"> â‚±4698 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±4698 </p> 
        </div>
      </div>

      <div class="product-box">
        <div class="product">
          <img src="item/appliances/AHOT-6272.png" class="product-image">
          <h3 class="product-name"> American Heritage AHOT-6272 13.0 Liters Electric Oven </h3>
          <p class="product-price" style="text-align: center;"> â‚±3199 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±3199 </p> 
        </div>
      </div>

      <div class="product-box">
        <div class="product">
          <img src="item/appliances/EO-26RCDG.jpg" class="product-image">
          <h3 class="product-name"> 3D EO-26RCDG 26 Liters Electric Oven </h3>
          <p class="product-price" style="text-align: center;"> â‚±4409 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±4409 </p> 
        </div>
      </div>

      <div class="product-box">
        <div class="product">
          <img src="item/appliances/08_-BSME048BL.png" class="product-image">
          <h3 class="product-name"> Brikk BSME048BL 48L Digital Oven </h3>
          <p class="product-price" style="text-align: center;"> â‚±7495 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±7495</p> 
        </div>
      </div>

      <div class="product-box">
        <div class="product">
          <img src="item/appliances/02_BHHM-7339C-1.png" class="product-image">
          <h3 class="product-name"> Brikk BHHM-7339C Hand Mixer with Mixing Bowl </h3>
          <p class="product-price" style="text-align: center;"> â‚±2999 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±2999</p> 
        </div>
      </div>

      <div class="product-box">
        <div class="product">
          <img src="item/appliances/SM-50RHK.png" class="product-image">
          <h3 class="product-name"> Cuisinart SM-50RHK 5.2 Liters Stand Mixer </h3>
          <p class="product-price" style="text-align: center;"> â‚±23795 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±23795</p> 
        </div>
      </div>

      <div class="product-box">
        <div class="product">
          <img src="item/appliances/SM-50BLHK_02.png" class="product-image">
          <h3 class="product-name"> Cuisinart SM-50BLHK 5.2 Liters Stand Mixer </h3>
          <p class="product-price" style="text-align: center;"> â‚±23795 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±23795</p> 
        </div>
      </div>

      <div class="product-box">
        <div class="product">
          <img src="item/appliances/08_-BSME048BL.png" class="product-image">
          <h3 class="product-name"> Brikk BSME048BL 48L Digital Oven </h3>
          <p class="product-price" style="text-align: center;"> â‚±7495 </p> 
          <div class="quantity-control">
            <button class="quantity-btn minus" onclick="changeQuantity(event, -1)"> - </button>
            <input type="number" class="quantity" value="1" min="0" step="1">
            <button class="quantity-btn plus" onclick="changeQuantity(event, 1)"> + </button>
          </div>
          <p class="item-total-price" style="text-align: center;"> â‚±7495</p> 
        </div>
      </div>

    </div> 

    <div class="cart-container">
      <button class="cart-btn">
        <span class="cart-icon"> ðŸ›’ </span>
        <span id="cart-count"> 0 </span>
      </button>
      <div id="cart-summary" class="cart-summary">
        <p> Total: <span id="total-price"> 0.00 </span></p>
      </div>
    </div>

    <script>
      let cart = []; // Array to store items in the cart

      // Function to handle quantity changes (Increase or Decrease)
      function changeQuantity(event, amount) {
          let quantityInput = event.target.parentElement.querySelector('.quantity');
          let currentQuantity = parseInt(quantityInput.value);

          // Ensure quantity stays at a minimum of 0 (allow zero for "no purchase")
          let newQuantity = Math.max(0, currentQuantity + amount);
          quantityInput.value = newQuantity;

          // Get the price of the product (strip the â‚± symbol before parsing)
          let priceText = event.target.parentElement.previousElementSibling.textContent;
          let price = parseFloat(priceText.replace('â‚±', '').trim()); // Strip the â‚± symbol and parse as number

          // Update the total price for this individual product
          let itemTotalPrice = newQuantity * price;
          event.target.parentElement.nextElementSibling.textContent = formatPrice(itemTotalPrice); // Format the price correctly

          // Now update the cart data
          updateCart(price, newQuantity);
      }

      // Update the cart data (add or update an item in the cart)
      function updateCart(price, quantity) {
          if (quantity === 0) {
              // If the quantity is 0, remove the item from the cart
              cart = cart.filter(item => item.price !== price);
          } else {
              // Check if the product already exists in the cart
              let productIndex = cart.findIndex(item => item.price === price);
              
              if (productIndex !== -1) {
                  // Update existing product in the cart
                  cart[productIndex].quantity = quantity;
              } else {
                  // Add new product to the cart
                  cart.push({ price: price, quantity: quantity });
              }
          }

          // Recalculate the cart totals
          recalculateCart();
      }

      // Function to recalculate the total quantity and price in the cart
      function recalculateCart() {
          let totalQuantity = 0;
          let totalPrice = 0;

          // Loop through the cart to calculate total items and price
          cart.forEach(item => {
              totalQuantity += item.quantity;
              totalPrice += item.price * item.quantity;
          });

          // Update the cart count and total price on the UI
          document.getElementById('cart-count').textContent = totalQuantity;
          document.getElementById('total-price').textContent = formatPrice(totalPrice);
      }

      // Helper function to format price in PHP (Peso)
      function formatPrice(amount) {
          return 'â‚±' + amount.toFixed(2); // Format as PHP currency
      }
    </script>
  </body>
</html>
